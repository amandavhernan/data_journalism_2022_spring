---
title: "Analyzing the United States' Incarcerated Adult Population"
author: "Amanda Hernandez"
date: "5/10/2022"
output: html_notebook
---

```{r}

library(tidyverse)
library(tidycensus)
library(dplyr)
library(sf)
library(tigris)
library(ggplot2)
library(usmap)
library(maps)
library(mapview)
library(leaflet)
library(htmlwidgets)
library(corrr)

census_api_key("8b69f2765f65670c2183febdffce6afc73c72101", install=TRUE, overwrite=TRUE)
readRenviron("~/.Renviron")

```

### Data Prep & Exploration

Before diving head first into this dataset, it's important to understand what this data means and what it represents. The dataset, which was downloaded from The Marshall Project's page on Observable (https://observablehq.com/@themarshallproject/adults-in-correctional-facilities-from-decennial-census), is composed of the number of adults in correctional facilities by county. This population data was collected by the U.S. Census Bureau in 2000, 2010, and 2020.

It's also important to note that the Census Bureau uses the term "correctional facility" to refer to federal detention centers, federal and state prisons, local jails, correctional residential facilities, and military jails.

When first downloaded and read into RStudio, the dataset will include the following variables or columns: 

* state -> State postal codes
* county -> County name
* FIPS -> 6-digit FIPS code for the county
* total_population_20 -> Total population of the county in the 2020 Census
* incarcerated_20 -> Number of incarcerated people in correctional facilities as of the 2020 Census
* total_population_10 -> Total population of the county in the 2010 Census
* incarcerated_10 -> Number of incarcerated people in correctional facilities as of the 2010 Census
* total_population_00 -> Total population of the county in the 2000 Census
* incarcerated_00 -> Number of incarcerated people in correctional facilities as of the 2000 Census

Although these variables are useful on their own, we'll also add some new ones below. This will help us better understand what potential patterns this data is showing us and how the data as a whole fits together. 

```{r}

incarcerated_pop <- read_csv("data/census_incarceration.csv") %>%
  rename(fips = FIPS) # this standardizes the column names

nrow(incarcerated_pop) # 3211 records
ncol(incarcerated_pop) # 9 columns/variables

View(incarcerated_pop)

# the following code adds columns that display the percent of a county's adult population that's incarcerated and the incarceration rates for 2000, 2010, and 2020

incarcerated_pop <- incarcerated_pop %>%
  mutate(percent_incarcerated_20 = (incarcerated_20/total_population_20)*100) %>%
  mutate(percent_incarcerated_10 = (incarcerated_10/total_population_10)*100) %>%
  mutate(percent_incarcerated_00 = (incarcerated_00/total_population_00)*100)

# write.csv(incarcerated_pop, "updated_census_incarceration.csv", row.names = TRUE)

# the next few lines of code returns a tibble displaying the counties with the highest percentages of incarcerated adult populations in 2020, 2010, and 2020

incarcerated_pop %>%
  arrange(desc(percent_incarcerated_20)) %>%
  select(state, county, percent_incarcerated_20)

# 2020
# CO	Crowley County	48.1256332		
# PA	Forest County	38.0467518		
# MS	Issaquena County	36.8460389		
# LA	West Feliciana Parish	34.5133899		
# GA	Wheeler County 31.6155802

incarcerated_pop %>%
  arrange(desc(percent_incarcerated_10)) %>%
  select(state, county, percent_incarcerated_10)

# 2010
# CO	Crowley County	45.6294007		
# TX	Concho County	38.0719354		
# LA	West Feliciana Parish	33.0944000		
# CO	Bent County	32.2818895		
# TX	Garza County	30.8775731	

incarcerated_pop %>%
  arrange(desc(percent_incarcerated_00)) %>%
  select(state, county, percent_incarcerated_00)

# 2000
# CO	Crowley County	35.4295034		
# LA	West Feliciana Parish	33.2340679		
# TX	Concho County	32.7534039		
# FL	Union County	30.2112781		
# IL	Brown County	27.5107914

```

After exploring the data a bit closer in the codeblock above, some interesting patterns appear. Crowley County and West Feliciana Parish, for example, are on every top five list for each year. It's also a bit alarming how high the incarceration rates are. In 2020, roughly 48% of Crowley County's population was incarcerated. That accounts for almost half of the population. Also, at least three of the counties in each list are located in the south.

Now that we have a better understanding of this data, the next codeblock creates data frames for each state. Each state data frame also have new columns that represent statewide data for 2000, 2010, and 2020. Here's a breakdown of those new columns and what they mean: 

> Important Note: The key below does not include numbers at the end as seen in the codeblock. The full column name would look like this -> total_state_pop_20. The numbers at the end represent either 2000 (00), 2010 (10), or 2020 (20).

* total_state_pop -> Total population for the state
* total_incarcerated -> Number of incarcerated people in correctional facilities statewide
* state_incarceration_rate -> Number of incarcerated people in correctional facilities statewide per 100,000 people (per capita)
* total_pct_incarcerated -> Total percent of state population incarcerated

As you load each data frame, it might look like there are some strange duplicates under the columns listed above. These duplicates are actually OK to keep. I used these figures to build another dataset we will use later.

### Creating State Dataframes

```{r}

# data frames for each state with total pop, total incarcerated, state incarceration rate, percent of state incarcerated (2000-2020)

massachusetts <- subset(incarcerated_pop, state == "MA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

connecticut <- subset(incarcerated_pop, state == "CT") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

west_virginia <- subset(incarcerated_pop, state == "WV") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

vermont <- subset(incarcerated_pop, state == "VT") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

rhode_island <- subset(incarcerated_pop, state == "RI") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

washington_dc <- subset(incarcerated_pop, state == "DC") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

pennsylvania <- subset(incarcerated_pop, state == "PA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

arkansas <- subset(incarcerated_pop, state == "AR") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

oklahoma <- subset(incarcerated_pop, state == "OK") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

nebraska <- subset(incarcerated_pop, state == "NE") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

idaho <- subset(incarcerated_pop, state == "ID") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

missouri <- subset(incarcerated_pop, state == "MO") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

louisiana <- subset(incarcerated_pop, state == "LA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

utah <- subset(incarcerated_pop, state == "UT") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

arizona <- subset(incarcerated_pop, state == "AZ") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

south_carolina <- subset(incarcerated_pop, state == "SC") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

georgia <- subset(incarcerated_pop, state == "GA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

tennessee <- subset(incarcerated_pop, state == "TN") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

new_york <- subset(incarcerated_pop, state == "NY") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

mississippi <- subset(incarcerated_pop, state == "MS") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

new_mexico <- subset(incarcerated_pop, state == "NM") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

illinois <- subset(incarcerated_pop, state == "IL") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

michigan <- subset(incarcerated_pop, state == "MI") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

maine <- subset(incarcerated_pop, state == "ME") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

indiana <- subset(incarcerated_pop, state == "IN") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

north_carolina <- subset(incarcerated_pop, state == "NC") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

delaware <- subset(incarcerated_pop, state == "DE") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

texas <- subset(incarcerated_pop, state == "TX") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

alabama <- subset(incarcerated_pop, state == "AL") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

california <- subset(incarcerated_pop, state == "CA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

virginia <- subset(incarcerated_pop, state == "VA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

south_dakota <- subset(incarcerated_pop, state == "SD") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

montana <- subset(incarcerated_pop, state == "MT") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

new_jersey <- subset(incarcerated_pop, state == "NJ") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

hawaii <- subset(incarcerated_pop, state == "HI") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

ohio <- subset(incarcerated_pop, state == "OH") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

minnesota <- subset(incarcerated_pop, state == "MN") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

oregon <- subset(incarcerated_pop, state == "OR") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

north_dakota <- subset(incarcerated_pop, state == "ND") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

kentucky <- subset(incarcerated_pop, state == "KY") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

new_hampshire <- subset(incarcerated_pop, state == "NH") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

colorado <- subset(incarcerated_pop, state == "CO") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

washington <- subset(incarcerated_pop, state == "WA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

alaska <- subset(incarcerated_pop, state == "AK") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

wyoming <- subset(incarcerated_pop, state == "WY") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

iowa <- subset(incarcerated_pop, state == "IA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

wisconsin <- subset(incarcerated_pop, state == "WI") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

florida <- subset(incarcerated_pop, state == "FL") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

kansas <- subset(incarcerated_pop, state == "KS") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

nevada <- subset(incarcerated_pop, state == "NV") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

maryland <- subset(incarcerated_pop, state == "MD") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

```

Now that all of the state data frames have loaded successfully, let's start taking an even closer look. Using the guiding questions below, you will start to see interesting patterns emerge.

First, let's look at incarcerations rates and how they compare to population over time.

#### 1. Over time, which 5 states had the highest incarceration rate per 100,000 people?

In 2020, the states with the highest incarceration rates were: 
* Louisiana				
* West Virginia				
* Mississippi			
* Oklahoma			
* Arkansas

In 2010, the states with the highest incarceration rates were: 
* Louisiana			
* Mississippi			
* Oklahoma			
* Georgia			
* Texas

In 2000, the states with the highest incarceration rates were: 
* Louisiana			
* Arizona			
* Texas			
* Georgia		
* Mississippi

Each year the Census was taken since 2000, Louisiana and Mississippi have always been in the top five for highest incarceration rates. Louisiana, in particular, has always been the state with the highest incarceration rate. Although the incarceration rate in Louisiana has dropped slightly since 2000, the data reveals a very interesting pattern about southern states and their incarceration rates — southern states seem to have the highest incarcerations rates compared to the rest of the United States. 

```{r}

# load state level dataset
state_incarceration_data <- read_csv("data/state_census_incarceration_data.csv")

# 2020 - incarceration rates

state_incarceration_data %>%
  arrange(desc(incarceration_rate_20)) %>%
  select(state, incarceration_rate_20) %>%
  head(5)

plot_usmap(data = state_incarceration_data, values = "incarceration_rate_20", color = "black") + 
  labs(title = "Incarcerations Rates Across the United States in 2020",
       subtitle = "Louisiana has the highest incarceration rate at 1100 per 100,000 people.") +
  scale_fill_continuous(
    low = "white", high = "deep sky blue 4", name = "Incarceration Rate", label = scales::comma) + theme(legend.position = "right")

# 2010 - incarceration rates

state_incarceration_data %>%
  arrange(desc(incarceration_rate_10)) %>%
  select(state, incarceration_rate_10) %>%
  head(5)

plot_usmap(data = state_incarceration_data, values = "incarceration_rate_10", color = "black") + 
  labs(title = "Incarcerations Rates Across the United States in 2010",
       subtitle = "Louisiana has the highest incarceration rate at 1341 per 100,000 people.") +
  scale_fill_continuous(
    low = "white", high = "deep sky blue 4", name = "Incarceration Rate", label = scales::comma) + theme(legend.position = "right")

# 2000 - incarceration rates

state_incarceration_data %>%
  arrange(desc(incarceration_rate_00)) %>%
  select(state, incarceration_rate_00) %>%
  head(5)

plot_usmap(data = state_incarceration_data, values = "incarceration_rate_10", color = "black") + 
  labs(title = "Incarcerations Rates Across the United States in 2000",
       subtitle = "Louisiana has the highest incarceration rate at 1360 per 100,000 people.") +
  scale_fill_continuous(
    low = "white", high = "deep sky blue 4", name = "Incarceration Rate", label = scales::comma) + theme(legend.position = "right")

```

Now that we have a better picture of what incarceration rates have looked over time across the United States, let's continue exploring our suspicion that southern states seem to have the highest incarceration rates compared to other U.S. regions. 

For this next question, we're using the regions designated by the Census to compare 2020 incarceration rates across four regions: northeast, midwest, west, and south. 

#### 2. Which U.S. region had the highest incarceration rates in 2020?

Based on the maps generated by the code below, it looks like Southern region of the United States generally has the highest incarceration rates. We can tell by looking at the legends of each map. The southern region map shows the southern region is the only one with incarceration rates over 1,000 per 100,000 residents.

The western region of the United States comes as a close second with high incarceration rates in the 800s. Next comes the midwest with high incarceration rates in the 700s and last comes the northeast with high incarceration rates in the 600s.

```{r}

# northeast region

plot_usmap(include = .northeast_region, data = state_incarceration_data, values = "incarceration_rate_20", color = "black") + scale_fill_continuous(low = "white", high = "deep sky blue 4", name = "Incarceration Rate", label = scales::comma) + theme(legend.position = "right")

# midwest region

plot_usmap(include = .midwest_region, data = state_incarceration_data, values = "incarceration_rate_20", color = "black") + scale_fill_continuous(low = "white", high = "deep sky blue 4", name = "Incarceration Rate", label = scales::comma) + theme(legend.position = "right")

# west region

plot_usmap(include = .west_region, data = state_incarceration_data, values = "incarceration_rate_20", color = "black") + scale_fill_continuous(low = "white", high = "deep sky blue 4", name = "Incarceration Rate", label = scales::comma) + theme(legend.position = "right")

# south region

plot_usmap(include = .south_region, data = state_incarceration_data, values = "incarceration_rate_20", color = "black") + scale_fill_continuous(low = "white", high = "deep sky blue 4", name = "Incarceration Rate", label = scales::comma) + theme(legend.position = "right")

```

To answer the following question, we'll use a cleaner version of our initial dataset. This new, county-level dataset also includes latitude and longitude coordinates and no longer has columns for state specific information. Before diving into our continued analysis of this data, we'll add on some new columns to find the net change in incarcerated population counts since 2000.

#### 3. Which were the top 10 U.S. counties that saw the largest net change in population counts since 2000? Alternatively, which were the top 10 U.S. counties that saw either a decrease or no change in prison population since 2010? 




```{r}

county_incarceration_data <- read_csv("data/county_census_incarceration_data.csv")

# turns data frame into a spatial object
sf_county_incarceration_data <- st_as_sf(county_incarceration_data, coords = c("longitude", "latitude"), crs = 4326) 

county_incarceration_data <- county_incarceration_data %>%
  mutate(net_change_00_10 = incarcerated_10-incarcerated_00) %>%
  mutate(net_change_10_20 = incarcerated_20-incarcerated_10) %>%
  mutate(net_change_00_20 = incarcerated_20-incarcerated_00)

# net change between 2000 and 2010

county_incarceration_data %>%
  arrange(desc(net_change_00_10)) %>%
  select(state, county, net_change_00_10) %>%
  head(10)

county_incarceration_data %>%
  arrange(net_change_00_10) %>%
  select(state, county, net_change_00_10) %>%
  head(10)

county_incarceration_data %>%
  filter(net_change_00_10 == 0) %>%
  select(state, county, net_change_00_10)

# static map
plot_usmap(regions = "counties", data = county_incarceration_data, values = "net_change_00_10", color = "black") +
  labs(title = "Title",
       subtitle = "Subtitle") +
  scale_fill_binned(type = "viridis", name = "Net Change", label = scales::comma) + 
  theme(legend.position = "right")
  
# interactive
mapview(sf_county_incarceration_data, zcol = "net_change_00_10")

# net change between 2010 and 2020

county_incarceration_data %>%
  arrange(desc(net_change_10_20)) %>%
  select(state, county, net_change_10_20) %>%
  head(10)

county_incarceration_data %>%
  arrange(net_change_10_20) %>%
  select(state, county, net_change_10_20) %>%
  head(10)

county_incarceration_data %>%
  filter(net_change_10_20 == 0) %>%
  select(state, county, net_change_10_20)

# net change between 2000 and 2020

county_incarceration_data %>%
  arrange(desc(net_change_00_20)) %>%
  select(state, county, net_change_00_20) %>%
  head(10)

county_incarceration_data %>%
  arrange(net_change_00_20) %>%
  select(state, county, net_change_00_20) %>%
  head(10)

county_incarceration_data %>%
  filter(net_change_00_20 == 0) %>%
  select(state, county, net_change_00_20)

```

Now, let's look at what percentage makes up the incarcerated population in each state and compare it to figures from 2010 and 2000. Have they changed at all? What could account for that change?

#### 4. For each U.S. state, roughly how much (%) of the state’s adult population was incarcerated/being held in a correctional facility in 2020? Compare it to figures from 2010 and 2000.

```{r}

# 2020

plot_usmap(data = incarceration_rates_pct, values = "pct_incarcerated_20", color = "black") + 
  labs(title = "Percent of Total Population Incarcerated by State in 2020") +
  scale_fill_continuous(
    low = "white", high = "deep pink 4", name = "Percent Incarcerated", label = scales::comma) + theme(legend.position = "right")

# 2010

plot_usmap(data = incarceration_rates_pct, values = "pct_incarcerated_10", color = "black") + 
  labs(title = "Percent of Total Population Incarcerated by State in 2010") +
  scale_fill_continuous(
    low = "white", high = "deep pink 4", name = "Percent Incarcerated", label = scales::comma) + theme(legend.position = "right")

# 2000

plot_usmap(data = incarceration_rates_pct, values = "pct_incarcerated_00", color = "black") + 
  labs(title = "Percent of Total Population Incarcerated by State in 2000") +
  scale_fill_continuous(
    low = "white", high = "deep pink 4", name = "Percent Incarcerated", label = scales::comma) + theme(legend.position = "right")

```

#### 5. Using ACS data, compare median household incomes and incarceration rates for Colorado, Pennsylvania, Mississippi, Louisiana, and Georgia.

For this final question, we're looking at the five states we found in the very first codeblock where we looked at the counties with the highest percentages of incarcerated population. As a refresher, those states/counties are listed below:


* CO	Crowley County	48.1256332		
* PA	Forest County	38.0467518		
* MS	Issaquena County	36.8460389		
* LA	West Feliciana Parish	34.5133899		
* GA	Wheeler County 31.6155802

Using ACS data, we'll extract the county-level median income estimates for each state and compare them to the county-level incarceration rates. Additionally, we'll use linear regression to explore the relationship between both variables.


```{r}

county_incarceration_data %>%
  arrange(desc(percent_incarcerated_20)) %>%
  select(state, county, percent_incarcerated_20)

# load ACS variables

acs_variables <- load_variables(year = 2020,
                      dataset = "acs5",
                      cache = TRUE)

# load median income estimates for Colorado, Pennsylvania, Mississippi, Louisiana, and Georgia

colorado_medincome <- get_acs(geography = "county",
              variables = c(medincome = "B19013_001"),
              state = "CO",
              year = 2020)

pennsylvania_medincome <- get_acs(geography = "county",
              variables = c(medincome = "B19013_001"),
              state = "PA",
              year = 2020)

mississippi_medincome <- get_acs(geography = "county",
              variables = c(medincome = "B19013_001"),
              state = "MS",
              year = 2020)

louisiana_medincome <- get_acs(geography = "county",
              variables = c(medincome = "B19013_001"),
              state = "LA",
              year = 2020)

georgia_medincome <- get_acs(geography = "county",
              variables = c(medincome = "B19013_001"),
              state = "GA",
              year = 2020)

# clean ACS data frames to prepare for mapping and joining

colorado_medincome <- colorado_medincome %>%
  rename(county = NAME) %>%
  rename(fips = GEOID) %>%
  mutate(county = (str_remove_all(county,", Colorado"))) %>%
  mutate(fips = str_sub(fips, 3, 5))
 
  
  
  


  

pennsylvania_medincome <- pennsylvania_medincome %>%
  rename(county = NAME) %>%
  mutate(county = (str_remove_all(county,", Pennsylvania")))

mississippi_medincome <- mississippi_medincome %>%
  rename(county = NAME) %>%
  mutate(county = (str_remove_all(county,", Mississippi")))

louisiana_medincome <- louisiana_medincome %>%
  rename(county = NAME) %>%
  mutate(county = (str_remove_all(county,", Louisiana")))

georgia_medincome <- georgia_medincome %>%
  rename(county = NAME) %>%
  mutate(county = (str_remove_all(county,", Georgia")))
  
# median income maps








plot_usmap("counties", include = "CO", color = "black", data = colorado_medincome, values = "estimate") + scale_fill_continuous(
    low = "white", high = "red", name = "Population (2015)", label = scales::comma
  ) + theme(legend.position = "right")




plot_usmap(include = c("CO"), regions = "counties", data = colorado_medincome, values = "estimate", color = "black") + labs(title = "Title",
       subtitle = "Subtitle") +
  scale_fill_binned(type = "viridis", name = "Net Change", label = scales::comma) + 
  theme(legend.position = "right")





# load incarceration rates for Colorado, Pennsylvania, Mississippi, Louisiana, and Georgia

colorado_incarceration <- county_incarceration_data %>%
  filter(state == "CO") %>%
  select(state, county, percent_incarcerated_20)

pennsylvania_incarceration <- county_incarceration_data %>%
  filter(state == "PA") %>%
  select(state, county, percent_incarcerated_20)

mississippi_incarceration <- county_incarceration_data %>%
  filter(state == "MS") %>%
  select(state, county, percent_incarcerated_20)

louisiana_incarceration <- county_incarceration_data %>%
  filter(state == "LA") %>%
  select(state, county, percent_incarcerated_20)

georgia_incarceration <- county_incarceration_data %>%
  filter(state == "GA") %>%
  select(state, county, percent_incarcerated_20)



# join dataframes

  
joined_wv_mining_ppp <- wv_pop_by_county %>%
  left_join(wv_mining_ppp, by=c('COUNTY'='project_county_name')) %>%
  mutate(amount_per_100k = sum_loans/population*100000) %>%
  arrange(desc(amount_per_100k))














reveal_data %>%
  ggplot() +
  geom_point(aes(x=pct_trump,y=businesses_receiving_ppe_pct)) +
  geom_smooth(aes(x=pct_trump,y=businesses_receiving_ppe_pct), method="lm")










```

#### Summary

