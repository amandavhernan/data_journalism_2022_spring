---
title: "Analyzing the United States' Incarcerated Adult Population"
author: "Amanda Hernandez"
date: "5/3/2022"
output: html_notebook
---

```{r}

library(tidyverse)
library(tidycensus)
library(dplyr)
library(sf)
library(tigris)
library(ggplot2)
library(usmap)
library(gganimate)
library(gifski)

census_api_key("8b69f2765f65670c2183febdffce6afc73c72101", install=TRUE, overwrite=TRUE)
readRenviron("~/.Renviron")

```

### Data Prep & Exploration

Before diving head first into this dataset, it's important to understand what this data means and what it represents. The dataset, which was downloaded from The Marshall Project's page on Observable (https://observablehq.com/@themarshallproject/adults-in-correctional-facilities-from-decennial-census), is composed of the number of adults in correctional facilities by county. This population data was collected by the U.S. Census Bureau in 2000, 2010, and 2020.

It's also important to note that the Census Bureau uses the term "correctional facility" to refer to federal detention centers, federal and state prisons, local jails, correctional residential facilities, and military jails.

When first downloaded and read into RStudio, the dataset will include the following variables or columns: 

* state -> State postal codes
* county -> County name
* FIPS -> 6-digit FIPS code for the county
* total_population_20 -> Total population of the county in the 2020 Census
* incarcerated_20 -> Number of incarcerated people in correctional facilities as of the 2020 Census
* total_population_10 -> Total population of the county in the 2010 Census
* incarcerated_10 -> Number of incarcerated people in correctional facilities as of the 2010 Census
* total_population_00 -> Total population of the county in the 2000 Census
* incarcerated_00 -> Number of incarcerated people in correctional facilities as of the 2000 Census

Although these variables are useful on their own, we'll also add some new ones below. This will help us better understand what potential patterns this data is showing us and how the data as a whole fits together. 

```{r}

incarcerated_pop <- read_csv("data/census_incarceration.csv") %>%
  rename(fips = FIPS) # this standardizes the column names

nrow(incarcerated_pop) # 3211 records
ncol(incarcerated_pop) # 9 columns/variables

View(incarcerated_pop)

# the following code adds columns that display the percent of a county's adult population that's incarcerated for 2000, 2010, and 2020

incarcerated_pop <- incarcerated_pop %>%
  mutate(percent_incarcerated_20 = (incarcerated_20/total_population_20)*100) %>%
  mutate(percent_incarcerated_10 = (incarcerated_10/total_population_10)*100) %>%
  mutate(percent_incarcerated_00 = (incarcerated_00/total_population_00)*100)

# the next few lines of code returns a tibble displaying the counties with the highest percentages of incarcerated adult populations in 2020

incarcerated_pop %>%
  arrange(desc(percent_incarcerated_20)) %>%
  select(state, county, percent_incarcerated_20)

# 2020
# CO	Crowley County	48.1256332		
# PA	Forest County	38.0467518		
# MS	Issaquena County	36.8460389		
# LA	West Feliciana Parish	34.5133899		
# GA	Wheeler County 31.6155802

incarcerated_pop %>%
  arrange(desc(percent_incarcerated_10)) %>%
  select(state, county, percent_incarcerated_10)

# 2010
# CO	Crowley County	45.6294007		
# TX	Concho County	38.0719354		
# LA	West Feliciana Parish	33.0944000		
# CO	Bent County	32.2818895		
# TX	Garza County	30.8775731	

incarcerated_pop %>%
  arrange(desc(percent_incarcerated_00)) %>%
  select(state, county, percent_incarcerated_00)

# 2000
# CO	Crowley County	35.4295034		
# LA	West Feliciana Parish	33.2340679		
# TX	Concho County	32.7534039		
# FL	Union County	30.2112781		
# IL	Brown County	27.5107914

```

After exploring the data a bit closer in the codeblock above, some interesting patterns appear. Crowley County and West Feliciana Parish, for example, are on every top five list for each year. Also, at least three of the counties in each list are located in Southern states. 

Now that we have a better understanding of this data, the next codeblock creates dataframes for each state. Each state dataframe also have new columns that represent statewide data for 2000, 2010, and 2020. Here's a breakdown of those new columns and what they mean: 

> Important Note: The key below does not include numbers at the end as seen in the codeblock. The full column name would look like this -> total_state_pop_20. The numbers at the end represent either 2000 (00), 2010 (10), or 2020 (20).

* total_state_pop -> Total population for the state
* total_incarcerated -> Number of incarcerated people in correctional facilities statewide
* state_incarceration_rate -> Number of incarcerated people in correctional facilities statewide per 100,000 people (per capita)
* total_pct_incarcerated -> Total percent of state population incarcerated

As you load each dataframe, it might look like there are some strange duplicates under the columns listed above. These duplicates are actually OK to keep. I used these figures to build another dataset we will use later.

### Creating State Dataframes

```{r}

# dataframes for each state w/ total pop, total incarcerated, state incarceration rate, percent of state incarcerated (2000-2020)

massachusetts <- subset(incarcerated_pop, state == "MA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

connecticut <- subset(incarcerated_pop, state == "CT") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

west_virginia <- subset(incarcerated_pop, state == "WV") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

vermont <- subset(incarcerated_pop, state == "VT") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

rhode_island <- subset(incarcerated_pop, state == "RI") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

washington_dc <- subset(incarcerated_pop, state == "DC") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

pennsylvania <- subset(incarcerated_pop, state == "PA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

arkansas <- subset(incarcerated_pop, state == "AR") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

oklahoma <- subset(incarcerated_pop, state == "OK") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

nebraska <- subset(incarcerated_pop, state == "NE") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

idaho <- subset(incarcerated_pop, state == "ID") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

missouri <- subset(incarcerated_pop, state == "MO") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

louisiana <- subset(incarcerated_pop, state == "LA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

utah <- subset(incarcerated_pop, state == "UT") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

arizona <- subset(incarcerated_pop, state == "AZ") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

south_carolina <- subset(incarcerated_pop, state == "SC") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

georgia <- subset(incarcerated_pop, state == "GA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

tennessee <- subset(incarcerated_pop, state == "TN") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

new_york <- subset(incarcerated_pop, state == "NY") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

mississippi <- subset(incarcerated_pop, state == "MS") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

new_mexico <- subset(incarcerated_pop, state == "NM") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

illinois <- subset(incarcerated_pop, state == "IL") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

michigan <- subset(incarcerated_pop, state == "MI") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

maine <- subset(incarcerated_pop, state == "ME") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

indiana <- subset(incarcerated_pop, state == "IN") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

north_carolina <- subset(incarcerated_pop, state == "NC") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

delaware <- subset(incarcerated_pop, state == "DE") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

texas <- subset(incarcerated_pop, state == "TX") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

alabama <- subset(incarcerated_pop, state == "AL") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

california <- subset(incarcerated_pop, state == "CA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

virginia <- subset(incarcerated_pop, state == "VA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

south_dakota <- subset(incarcerated_pop, state == "SD") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

montana <- subset(incarcerated_pop, state == "MT") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

new_jersey <- subset(incarcerated_pop, state == "NJ") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

hawaii <- subset(incarcerated_pop, state == "HI") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

ohio <- subset(incarcerated_pop, state == "OH") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

minnesota <- subset(incarcerated_pop, state == "MN") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

oregon <- subset(incarcerated_pop, state == "OR") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

north_dakota <- subset(incarcerated_pop, state == "ND") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

kentucky <- subset(incarcerated_pop, state == "KY") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

new_hampshire <- subset(incarcerated_pop, state == "NH") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

colorado <- subset(incarcerated_pop, state == "CO") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

washington <- subset(incarcerated_pop, state == "WA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

alaska <- subset(incarcerated_pop, state == "AK") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

wyoming <- subset(incarcerated_pop, state == "WY") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

iowa <- subset(incarcerated_pop, state == "IA") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

wisconsin <- subset(incarcerated_pop, state == "WI") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

florida <- subset(incarcerated_pop, state == "FL") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

kansas <- subset(incarcerated_pop, state == "KS") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

nevada <- subset(incarcerated_pop, state == "NV") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

maryland <- subset(incarcerated_pop, state == "MD") %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>% 
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000) %>%
  mutate(total_pct_incarcerated_20 = total_incarcerated_20/total_state_pop_20*100) %>% # 2010 below
  mutate(total_state_pop_10 = sum(total_population_10)) %>%
  mutate(total_incarcerated_10 = sum(incarcerated_10)) %>%
  mutate(state_incarceration_rate_10 = total_incarcerated_10/total_state_pop_10*100000) %>%
  mutate(total_pct_incarcerated_10 = total_incarcerated_10/total_state_pop_10*100) %>% # 2000 below
  mutate(total_state_pop_00 = sum(total_population_00)) %>%
  mutate(total_incarcerated_00 = sum(incarcerated_00)) %>%
  mutate(state_incarceration_rate_00 = total_incarcerated_10/total_state_pop_00*100000) %>%
  mutate(total_pct_incarcerated_00 = total_incarcerated_10/total_state_pop_00*100)

```

Now that all of the state dataframes have loaded successfully, let's start taking an even closer look. Using the guiding questions below, you will start to see interesting patterns emerge.

First, let's look at incarcerations rates and how they compare to population over time.

#### 1. Which states had the highest incarceration rate per 100,000 people over time (2000-2020)? How does it compare to changes in population?

```{r}

incarceration_rates_pct <- read_csv("data/state_incarceration_rates_pct.csv")

# 2020 - incarceration rates

incarceration_rates_pct %>%
  arrange(desc(incarceration_rate_20)) %>%
  select(state, incarceration_rate_20) %>%
  head(10)

plot_usmap(data = incarceration_rates_pct, values = "incarceration_rate_20", color = "black") + 
  labs(title = "Incarcerations Rates Across the United States in 2020",
       subtitle = "Louisiana has the highest incarceration rate at 1100 per 100,000 people.") +
  scale_fill_continuous(
    low = "white", high = "deep sky blue 4", name = "Incarceration Rate", label = scales::comma) + theme(legend.position = "right")

# 2020 - population

plot_usmap(data = incarceration_rates_pct, values = "total_state_pop_20", color = "black") +
  scale_fill_continuous(low = "white", high = "deep sky blue 4", name = "Population", label = scales::comma) + theme(legend.position = "right") +
  scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0))

# 2010 - incarceration rates

incarceration_rates_pct %>%
  arrange(desc(incarceration_rate_10)) %>%
  select(state, incarceration_rate_10) %>%
  head(10)

plot_usmap(data = incarceration_rates_pct, values = "incarceration_rate_10", color = "black") + 
  labs(title = "Incarcerations Rates Across the United States in 2010",
       subtitle = "Louisiana has the highest incarceration rate at 1341 per 100,000 people.") +
  scale_fill_continuous(
    low = "white", high = "deep sky blue 4", name = "Incarceration Rate", label = scales::comma) + theme(legend.position = "right")

# 2010 - population

plot_usmap(data = incarceration_rates_pct, values = "total_state_pop_10", color = "black") +
  scale_fill_continuous(low = "white", high = "deep sky blue 4", name = "Population", label = scales::comma) + theme(legend.position = "right") +
  scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0))

# 2000 - incarceration rates

incarceration_rates_pct %>%
  arrange(desc(incarceration_rate_00)) %>%
  select(state, incarceration_rate_00) %>%
  head(10)

plot_usmap(data = incarceration_rates_pct, values = "incarceration_rate_10", color = "black") + 
  labs(title = "Incarcerations Rates Across the United States in 2000",
       subtitle = "Louisiana has the highest incarceration rate at 1360 per 100,000 people.") +
  scale_fill_continuous(
    low = "white", high = "deep sky blue 4", name = "Incarceration Rate", label = scales::comma) + theme(legend.position = "right")

# 2000 - population

plot_usmap(data = incarceration_rates_pct, values = "total_state_pop_00", color = "black") +
  scale_fill_continuous(low = "white", high = "deep sky blue 4", name = "Population", label = scales::comma) + theme(legend.position = "right") +
  scale_x_continuous(expand = c(0, 0)) + scale_y_continuous(expand = c(0, 0))

```

```{r}

# practicing map animation




```


#### 2. Which U.S. region has the highest incarceration rates?

Based on the graphics generated by the code below, it looks like Southern region of the United States generally has the highest incarceration rates.

```{r}

# northeast

plot_usmap(include = .northeast_region, data = incarceration_rates, values = "incarceration_rate", color = "black") + theme(legend.position = "right")

# midwest

plot_usmap(include = .midwest_region, data = incarceration_rates, values = "incarceration_rate", color = "black") + theme(legend.position = "right")

# west

plot_usmap(include = .west_region, data = incarceration_rates, values = "incarceration_rate", color = "black") + theme(legend.position = "right")

# south 

plot_usmap(include = .south_region, data = incarceration_rates, values = "incarceration_rate", color = "black") + theme(legend.position = "right")

```
#### 3. Which were the top 10 U.S. counties that saw the largest percent increase in prison population since 2010? Alternatively, which were the top 10 U.S. counties that saw either a decrease or no change in prison population since 2010? 

```{r}

# net change (direct subtraction over years)

percent_counties_00 <- incarcerated_pop %>%
  select(fips, percent_incarcerated_00)

percent_counties_10 <- incarcerated_pop %>%
  select(fips, percent_incarcerated_10)

percent_counties_20 <- incarcerated_pop %>%
  select(fips, percent_incarcerated_20)
  
# 2000

incarcerated_pop %>%
  arrange(desc(percent_incarcerated_00)) %>%
  select(state, county, percent_incarcerated_00) %>%
  head(10)

# county level map
plot_usmap(regions = "counties", data = percent_counties_00, values = "percent_incarcerated_00", color = "black") +
  labs(title = "Title",
       subtitle = "Subtitle") +
  scale_fill_continuous(low = "#c9d9c9", high = "#236d32", name = "Legend", label = scales::comma) + 
  theme(legend.position = "right")

# 2010

incarcerated_pop %>%
  arrange(desc(percent_incarcerated_10)) %>%
  select(state, county, percent_incarcerated_10) %>%
  head(10)

# county level map
plot_usmap(regions = "counties", data = percent_counties_10, values = "percent_incarcerated_10", color = "black") +
  labs(title = "Title",
       subtitle = "Subtitle") +
  scale_fill_continuous(low = "#c9d9c9", high = "#236d32", name = "Legend", label = scales::comma) + 
  theme(legend.position = "right")


# 2020

incarcerated_pop %>%
  arrange(desc(percent_incarcerated_20)) %>%
  select(state, county, percent_incarcerated_20) %>%
  head(10)

# county level map
plot_usmap(regions = "counties", data = percent_counties_20, values = "percent_incarcerated_20", color = "black") +
  labs(title = "Title",
       subtitle = "Subtitle") +
  scale_fill_continuous(low = "#c9d9c9", high = "#236d32", name = "Legend", label = scales::comma) + 
  theme(legend.position = "right")

```

#### 4. For each U.S. state, roughly how much (%) of the state’s adult population was incarcerated/being held in a correctional facility in 2020? Compare it to figures from 2010 and 2000.

```{r}

# 2020

plot_usmap(data = incarceration_rates_pct, values = "pct_incarcerated_20", color = "black") + 
  labs(title = "Percent of Total Population Incarcerated by State in 2020") +
  scale_fill_continuous(
    low = "white", high = "deep pink 4", name = "Percent Incarcerated", label = scales::comma) + theme(legend.position = "right")

# 2010

plot_usmap(data = incarceration_rates_pct, values = "pct_incarcerated_10", color = "black") + 
  labs(title = "Percent of Total Population Incarcerated by State in 2010") +
  scale_fill_continuous(
    low = "white", high = "deep pink 4", name = "Percent Incarcerated", label = scales::comma) + theme(legend.position = "right")

# 2000

plot_usmap(data = incarceration_rates_pct, values = "pct_incarcerated_00", color = "black") + 
  labs(title = "Percent of Total Population Incarcerated by State in 2000") +
  scale_fill_continuous(
    low = "white", high = "deep pink 4", name = "Percent Incarcerated", label = scales::comma) + theme(legend.position = "right")

```

#### 5. Using ACS data, find out which racial or ethnic groups make up the majority in the top 10 U.S. counties that saw the largest increase in prison population since 2010?

```{r}

```


### Example County Level Maps (Percent Incarcerated)

```{r}

# Maryland

md_geo <- get_acs(geography = "county",
      variables = c(population = "B01001_001"),
      state = "MD",
      geometry = TRUE)

md_geo <- md_geo %>% 
  select(-variable, -estimate, -moe) %>%
  rename(geoid = GEOID) %>%
  rename(county = NAME) %>%
  mutate(county = str_remove_all(county,", Maryland"))

# total state pop + state incarceration rate 2020

maryland <- maryland %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>%
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000)

# join dataframes

maryland <- md_geo %>%
  left_join(maryland, by="county")

# map prep

counties <- counties()

md_counties <- counties %>%
  filter(STATEFP == "24")

# map

ggplot() + 
  geom_sf(data=maryland, aes(fill=percent_incarcerated_20)) +
  theme_minimal() +
  scale_fill_viridis_b(option="magma")


# Virginia

va_geo <- get_acs(geography = "county",
      variables = c(population = "B01001_001"),
      state = "VA",
      geometry = TRUE)

va_geo <- va_geo %>% 
  select(-variable, -estimate, -moe) %>%
  rename(geoid = GEOID) %>%
  rename(county = NAME) %>%
  mutate(county = str_remove_all(county,", Virginia"))

virginia <- virginia %>%
  mutate(total_state_pop_20 = sum(total_population_20)) %>%
  mutate(total_incarcerated_20 = sum(incarcerated_20)) %>%
  mutate(state_incarceration_rate_20 = total_incarcerated_20/total_state_pop_20*100000)

# join dataframes

virginia <- va_geo %>%
  left_join(virginia, by="county")

counties <- counties()

va_counties <- counties %>%
  filter(STATEFP == "51")


ggplot() + 
  geom_sf(data=virginia, aes(fill=percent_incarcerated_20)) +
  theme_minimal() +
  scale_fill_viridis_b(option="magma")

```
